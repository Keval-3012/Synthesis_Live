@model IEnumerable<EntityModels.Models.GroupMaster>
@{
    Layout = null;
}
@using Utility
<style>
    .divIDClass {
        z-index: 999999 !important;
    }
</style>
<div id="grddata">
    <div class="animate-panelmessesgarea padbtmzero">
        @if (ViewBag.StatusMessageString != null)
        {
            if (ViewBag.StatusMessageString != "")
            {
                <script>
                MyCustomToster('@ViewBag.StatusMessageString');
                </script>
            }
        }
    </div>
    <div class="page-body headertopbox addinvoice" style="padding-top:0px!important;">
        <div class="searchfinal">
            <div class="widget-body shadownone brdrgray">

                <div class="dataTables_wrapper form-inline dt-bootstrap no-footer">
                    <div class="dataTables_filter">
                        <table border="0" cellspacing="0" width="100%" style="text-align: right; margin-bottom: 0px;" cellpadding="0">
                            <tr>
                                <td width="265">
                                    <div class="input-group postion_div">
                                        <input name="txtSearchTitle" type="text" maxlength="100" id="txtSearchTitle" placeholder="Search" class="form-control m-b">
                                        <a href="#" class="search_close" onclick="cleartextsearch();">x</a>
                                    </div>
                                    <div class="input-group">
                                        <input type="submit" name="btnSearch" value="Search" id="btnSearch" onclick="javascript:FunSearchRecord();" class=".searchfinal .btnsearchicon" />
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        @{
            <div class="datagrid martop15">
                <div class="table-responsive">
                    <table class="table table-striped table-hover" style="width:102.5% !important;">
                        <thead>
                            <tr>

                                <th width="80%"><a class="textred" onclick="javascript:FunSortData('Name');" style="color:#fff; text-decoration:none; cursor:pointer;">Group Name</a></th>
                                <th width="20%" class="text-right">Action</th>

                            </tr>
                        </thead>
                        <tbody>

                            @{if (Model.Count() > 0)
                                {
                                    foreach (var item in Model)
                                    {

                                        var CatInGalary = 0;

                                        <tr class="even">
                                            <td style="vertical-align:middle;text-align:left;">@Html.Raw(item.Name)</td>
                                            <td style="vertical-align:middle;text-align:right" class="img_with img_color">
                                                <input type="hidden" id="ID" name="ID" value="@item.GroupId" />
                                                <a href="@Url.Action("Edit", "CompanyGroups", new { id = item.GroupId })" data-toggle="tooltip" data-placement="top" data-original-title="Edit"><img src="~/Content/Admin/images/edit-2.svg" alt="" /></a>

                                                @{
                                                    var UserIdD = @item.GroupId + "D";
                                                }

                                                @if (CatInGalary == 0)
                                                {
                                                    <a href="#" onclick="return ComfirmDelete(@item.GroupId);" data-toggle="tooltip" data-placement="top" data-original-title="Delete"><img src="../Content/Admin/images/trash-2.svg" alt="" /> </a>
                                                }
                                                <div id="@UserIdD" class="divIDClass modal-popup modal-danger modal-message" style="position: fixed;  left:45%; width:300px; top: 10px; display:none">
                                                    <div class="modal-content ">
                                                        <div class="modal-header text-center">
                                                            <i class="glyphicon glyphicon-trash"></i>
                                                        </div>
                                                        <div class="modal-title">Message</div>
                                                        <div class="modal-body ">Are you sure want to delete this Group?</div>
                                                        <div class="modal-footer" style="text-align:center">
                                                            <a class="btn btn-danger" onclick="Delete(@item.GroupId);">Ok </a>
                                                            <a class="btn" data-dismiss="modal" onclick="closemodal()">Cancel</a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                }
                                else
                                {
                                    <tr>
                                        <td colspan="2" class="text-center">No Data Available</td>

                                    </tr>
                                }
                            }

                            <tr class="paginationGrid">
                                <td class="left-text dataTables_length showdata" style="padding-top: 0px!important;">
                                    <div class="recordbox">
                                        <span class="selectbox">
                                            @{
                                                List<SelectListItem> listItem_Records = new List<SelectListItem>();
                                                string[] Records = AdminSiteConfiguration.GetArrayForRecord().ToString().Split(',');
                                                foreach (string word in Records)
                                                {
                                                    listItem_Records.Add(new SelectListItem
                                                    {
                                                        Text = word.Split(':')[0],
                                                        Value = word.Split(':')[1]
                                                    });
                                                }

                                                @Html.DropDownList("SelectRecords", listItem_Records, new { @class = "myval", @onchange = "javascript:FunPageRecord(this.value);" })
                                            }
                                        </span><span class="text_record">Records</span>
                                    </div>
                                    <div class="showdatabox">
                                        <span style="float:left">Showing @ViewBag.startIndex to @ViewBag.endIndex of @ViewBag.TotalDataCount entries</span>
                                    </div>

                                </td>
                                <td>

                                    <div class="pagination">
                                        @if (ViewBag.LastPageIndex > 1)
                                        {
                                            if (ViewBag.CurrentPageIndex != 1)
                                            {
                                                <a id="btnPageFirst" style="cursor:pointer" onclick="javascript:FunPageIndex(1);" class=" Linkbutton firstpage nextbtn">First</a>
                                                <a id="btnPagePrevious" style="cursor:pointer" onclick="javascript:FunPageIndex(@ViewBag.CurrentPageIndex    -1);" class=" Linkbutton Linkbutton prebtn">Previous</a>
                                            }
                                            int PageIndex = 3;
                                            int StartPageIndex = ViewBag.CurrentPageIndex - PageIndex;//10-3=7
                                            int EndPageIndex = ViewBag.CurrentPageIndex + PageIndex;//10+3=13

                                            if (StartPageIndex < 1)
                                            {
                                                EndPageIndex = EndPageIndex - StartPageIndex;
                                            }

                                            if (EndPageIndex > ViewBag.LastPageIndex)
                                            {
                                                StartPageIndex = (StartPageIndex - (EndPageIndex - ViewBag.LastPageIndex)) + 1;
                                            }

                                            for (int i = 1; i <= @ViewBag.LastPageIndex; i++)
                                            {

                                                if ((StartPageIndex < i && EndPageIndex > i))
                                                {
                                                    if (ViewBag.CurrentPageIndex == i)
                                                    {
                                                        <span Style="min-width: 25px; display: inline-block;">@i          </span>
                                                    }
                                                    else
                                                    {
                                                        <a id="btnnum" style="cursor:pointer" onclick="javascript:FunPageIndex(@i);">@i</a>
                                                    }
                                                }
                                            }
                                            if (ViewBag.CurrentPageIndex != @ViewBag.LastPageIndex)
                                            {
                                                <a id="btnPageNext" style="cursor:pointer" onclick="javascript:FunPageIndex(@ViewBag.CurrentPageIndex    +1);" class=" Linkbutton nextbtn">Next</a>
                                                <a id="btnPageLast" style="cursor:pointer" onclick="javascript:FunPageIndex(@ViewBag.LastPageIndex);" class=" Linkbutton lastpage nextbtn">Last</a>
                                            }
                                        }
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        }

    </div>
</div>
<div id="displayAddPanelPopup">
</div>

<script>
    $(document).ready(function () {
        $("#txtSearchTitle").focus();

    });
</script>

<script>
    var top=0;
    function Loader(val)
    {
        var doc = document.documentElement;
        $("[data-toggle=tooltip]").tooltip();
        if(val==1){
            $("#secloader").removeClass('pace-active1');
            $("#secloader").addClass('pace-active');
            $("#dvloader").removeClass('bak1');
            $("#dvloader").addClass('bak');
            $("#globalFooter").addClass('LoaderFooter');
            top = (window.pageYOffset || doc.scrollTop)  - (doc.clientTop || 0);
        }
        else{
            $("#secloader").removeClass('pace-active');
            $("#secloader").addClass('pace-active1');
            $("#dvloader").removeClass('bak');
            $("#dvloader").addClass('bak1');
            $("#globalFooter").removeClass('LoaderFooter');
            doc.scrollTop=top;
        }
        bind();
    }
    $('.burgermenu').click(function () {
        $('#sidebar').toggleClass('showmenu');
        $('.page-content').toggleClass('marleft110');
    })

    function FunSearchRecord()//Search
    {
        window.FunSearchRecord=FunSearchRecord
        var element_txtSearchTitle = document.getElementById('txtSearchTitle').value;
        GetData(1,1,'@ViewBag.OrderByVal',@ViewBag.IsAscVal,@ViewBag.PageSize,'','',element_txtSearchTitle);
    }

    function FunPageIndex(pageindex)//grid pagination
    {
        GetData(0,pageindex, '@ViewBag.OrderByVal',@ViewBag.IsAscVal,@ViewBag.PageSize,'@ViewBag.Alpha',@ViewBag.SearchRecords,'@ViewBag.SearchTitle');
    }

    function FunSortData(SortData)//Grid header sorting
    {
        GetData(0,@ViewBag.CurrentPageIndex, SortData,@ViewBag.AscVal,@ViewBag.PageSize,'@ViewBag.Alpha',@ViewBag.SearchRecords,'@ViewBag.SearchTitle');
    }

    function FunPageRecord(PageRecord)//Grid Page per record
    {
        GetData(0,1, '@ViewBag.OrderByVal',@ViewBag.IsAscVal,PageRecord,'@ViewBag.Alpha',@ViewBag.SearchRecords,'@ViewBag.SearchTitle');
    }

    function FunAlphaSearchRecord(alpha)//Alpha Search
    {
        GetData(1,1,'@ViewBag.OrderByVal',@ViewBag.IsAscVal,@ViewBag.PageSize,alpha,@ViewBag.SearchRecords,'');
    }

    document.getElementById('txtSearchTitle').onkeypress = function (e) {
        if (e.keyCode == 13) {
            document.getElementById('btnSearch').click();
        }
    }

    var PageSize = '@ViewBag.PageSize';
    var SearchTitle = '@ViewBag.SearchTitle';
    var CurrentPageIndex = '@ViewBag.CurrentPageIndex';
    var OrderByVal = '@ViewBag.OrderByVal';
    var IsAscVal = '@ViewBag.IsAscVal';
    var Alpha = '@ViewBag.Alpha';
    var SearchRecords = '@ViewBag.SearchRecords';
    var DeleteGrp = '@ViewBag.DeleteGrp';
</script>

<script src="~/Form_JS/CompanyGroups.js?version=@System.Configuration.ConfigurationManager.AppSettings["version"].ToString()"></script>
