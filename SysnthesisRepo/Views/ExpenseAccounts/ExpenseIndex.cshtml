@using Syncfusion.EJ2
@using Newtonsoft.Json
@using System.Configuration;
@using Utility;
@{
    int i = 1;
}

@{
    string storeid = (Session["storeid"] == null ? "0" : Session["storeid"].ToString());
}
@{
    List<object> toolbarItems = new List<object>();
    toolbarItems.Add(new { text = "Add" });
    toolbarItems.Add(new { text = "Edit" });
    //toolbarItems.Add(new { text = "Delete", tooltipText = "Delete", prefixIcon = "e-delete", id = "delete" });
    if (storeid != "0")
    {
        //toolbarItems.Add(new { text = "Add" });
        //toolbarItems.Add(new { text = "Edit" });
        toolbarItems.Add(new { text = "Delete", tooltipText = "Delete", prefixIcon = "e-delete", id = "delete" });
    }
    toolbarItems.Add(new { text = "Search" });
    toolbarItems.Add(new { text = "PdfExport" });
    toolbarItems.Add(new { text = "ExcelExport" });

}
<link href="~/Content/ej2/bootstrap5.css" rel="stylesheet" />
<link href="~/Content/synfusion.css" rel="stylesheet" />
<style>
    .blur-background {
        filter: blur(5px); /* Adjust blur amount as needed */
        pointer-events: none; /* Allow clicks to pass through the blurred background */
    }

    .modal-backdrop {
        z-index: 0 !important;
    }

    .modal-header {
        border-bottom: 3px solid #a52f2f;
    }

    .header-small {
        margin-top: 0px !important;
    }

    #IModal {
        position: fixed;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        z-index: 9999;
        background: #010101b3;
    }

    #popupid {
        position: fixed;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        z-index: 9999;
        background: #010101b3;
    }

    .wraptd {
        white-space: normal !important;
    }
</style>

<style>
    .divIDClass {
        z-index: 999999 !important;
    }

    .datagrid .table tr td img {
        height: 30px;
    }

    .showbox {
        display: none !important;
    }

    #loadbox {
        position: fixed;
        top: 0px;
        left: 0px;
        width: 100%;
        height: 100%;
        background: #000;
        z-index: 999;
        display: none;
    }

    .tab {
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
    }

        /* Style the buttons that are used to open the tab content */
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
        }

            /* Change background color of buttons on hover */
            .tab button:hover {
                background-color: #ddd;
            }

            /* Create an active/current tablink class */
            .tab button.active {
                background-color: #ccc;
            }

    /* Style the tab content */
    .tabcontent {
        display: none;
        padding: 6px 12px;
        border: 1px solid #ccc;
        border-top: none;
    }
</style>

<style>
    .show-read-more .more-text {
        display: none;
    }

    #modl {
        background: none;
        color: inherit;
        border: none;
        padding: 0;
        font: inherit;
        cursor: pointer;
        outline: inherit;
    }

    #UploadFile {
        background: none;
        color: inherit;
        border: none;
        padding: 0;
        font: inherit;
        cursor: pointer;
        outline: inherit;
    }

    #dvBody {
        max-width: 1850px;
        min-width: 750px;
        height: 350px;
    }
</style>

<style>
    .page-header-main {
        padding: 0;
    }

    .page-sidebar.sidebar-fixed {
        top: 78px !important;
    }
</style>

<style>
    .fabric .empimg {
        background-color: #0078d6;
    }

    .material .empimg {
        background-color: #e3165b;
    }

    .highcontrast .empimg {
        background-color: #ffd939;
    }

    _:-ms-fullscreen, :root .highcontrast .e-userimg.sf-icon-Male::before,
    _:-ms-fullscreen, :root .highcontrast .e-userimg.sf-icon-FeMale::before {
        color: black;
    }

    .highcontrast .e-userimg.sf-icon-Male::before,
    .highcontrast .e-userimg.sf-icon-FeMale::before {
        color: black;
    }

    .bootstrap .empimg {
        background-color: #0078d6;
    }

    .bootstrap4 .empimg,
    .bootstrap5 .empimg {
        background-color: #0078d6;
    }

    .tailwind .empimg {
        background-color: #4f46e5;
    }

    .fluent .empimg {
        background-color: #106EBE;
    }

    #Emptext {
        top: -12px;
        left: 41px;
        position: relative;
    }

    .e-grid.e-rtl #Emptext {
        top: -12px;
        left: -41px;
        position: relative;
    }

    .empimg {
        height: 27px;
        width: 29px;
        border-radius: 14px;
    }


    .e-userimg.sf-icon-Male::before,
    .e-userimg.sf-icon-FeMale::before {
        font-size: 13px;
    }

    .e-userimg.sf-icon-Male, .e-userimg.sf-icon-FeMale {
        margin: 0px 8px;
        line-height: 26px;
        color: white;
        font-size: 13px;
    }

        .e-userimg.sf-icon-Male::before {
            content: '\e700';
        }

        .e-userimg.sf-icon-FeMale::before {
            content: '\e701';
        }


    /* td.e-rowcell.e-selectionbackground.e-active {
        background-color: transparent;
    }

    .e-hightheme td.e-rowcell.e-selectionbackground.e-active {
        background-color: transparent;
        color: white;
    }*/

    .e-bigger .e-grid .statustxt {
        position: relative;
        top: -2px;
    }

    .e-bigger .e-grid .statustxts {
        position: relative;
        top: -2px;
    }

    .rating .star {
        font-size: 132%;
        color: lightgrey;
    }

        .rating .star.checked {
            color: #ffa600;
        }

    td.e-rowcell .statustxt.e-activecolor {
        color: #00cc00;
        position: relative;
    }

    td.e-rowcell .statustxt.e-inactivecolor {
        color: #e60000;
        position: relative;
    }

    .bootstrap5 td.e-rowcell .statustxt.e-inactivecolor,
    .bootstrap5 td.e-rowcell .statustxt.e-activecolor {
        top: 8px;
    }

    .bootstrap5 .e-checkboxfiltertext .statustemp .statustxt.e-activecolor,
    .bootstrap5 .e-checkboxfiltertext .statustemp .statustxt.e-inactivecolor {
        position: relative;
        top: 1.5px;
    }

    .e-bigger.bootstrap5 .e-checkboxfiltertext .statustemp .statustxt.e-activecolor,
    .e-bigger.bootstrap5 .e-checkboxfiltertext .statustemp .statustxt.e-inactivecolor {
        top: -0.5px;
    }

    .bootstrap5 .e-checkboxfiltertext #Trusttext {
        margin-left: -4px;
    }

    .statustemp.e-inactivecolor {
        background-color: #ffd7cc;
    }

    .statustemp.e-activecolor {
        background-color: #ccffcc;
    }

    .statustemps.e-inactivecolor {
        background-color: #ffd7cc;
    }

    .statustemps.e-activecolor {
        background-color: #ccffcc;
    }

    .statustxts.e-activecolor {
        color: #00cc00;
    }

    .statustxts.e-inactivecolor {
        color: #e60000;
    }

    .statustxt.e-activecolor {
        color: #00cc00;
    }

    .statustxt.e-inactivecolor {
        color: #e60000;
    }

    #Trusttext {
        position: relative;
        top: 1px;
    }

    .e-image {
        height: 13px;
        width: 14px;
    }

    .statustemp.e-inactivecolor {
        width: 64px;
    }

    .statustemp.e-activecolor {
        width: 57px;
    }

    .statustemp {
        position: relative;
        height: 19px;
        border-radius: 5px;
        text-align: center
    }

    .statustemps.e-inactivecolor {
        width: 64px;
    }

    .statustemps.e-activecolor {
        width: 57px;
    }

    .statustemps {
        position: relative;
        height: 19px;
        border-radius: 5px;
        text-align: center
    }

    .highcontrast #msg {
        color: #FFFFFF
    }


    #msg {
        font-family: "Segoe UI", "GeezaPro", "DejaVu Serif", sans-serif;
        font-size: 14px;
        font-weight: 400;
        opacity: 0.95;
        color: #333;
        float: right;
        margin-top: 3px;
    }

    @@media only screen and (max-width: 370px) {
        #msg {
            float: left;
            margin-top: 3px;
        }

        #GridOverview {
            margin-top: 36px;
        }
    }

    #samplecontainer {
        padding-top: 5px;
    }

    #myProgress {
        position: relative;
        height: 18px;
        width: 10em;
        text-align: left;
        background-color: white;
    }

    .highcontrast .e-grid #myProgress {
        background-color: black;
    }

    #myBar {
        position: absolute;
        width: 10%;
        height: 100%;
        background-color: #00b300;
    }

        #myBar.progressdisable {
            background-color: #df2222;
        }

    #label {
        position: relative;
        left: 10px;
        line-height: 18px;
        font-size: 10px;
        color: white;
    }

    div#InlineEditing_dialogEdit_wrapper {
        width: 1100px !important;
    }
</style>

<style>
    @@font-face {
        font-family: 'Toast_icons';
        src: url(data:application/x-font-ttf;charset=utf-8;base64,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) format('truetype');
        font-weight: normal;
        font-style: normal;
    }

    #toast_types button {
        margin: 5px;
        min-width: 160px;
        max-width: 160px;
    }


    .toast-icons {
        font-family: 'Toast_icons' !important;
        speak: none;
        font-size: 55px;
        font-style: normal;
        font-weight: normal;
        font-variant: normal;
        text-transform: none;
        line-height: 1;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    #toast_type .e-toast-icon.e-icons {
        height: auto;
        font-size: 30px;
    }

    .bootstrap5 #toast_type .e-toast-icon.e-icons,
    .bootstrap5-dark #toast_type .e-toast-icon.e-icons {
        height: 25px;
    }

    .toast-icons.e-success::before {
        content: "\e701";
    }

    .toast-icons.e-error::before {
        content: "\e700";
    }

    .toast-icons.e-info::before {
        content: "\e704";
    }

    .toast-icons.e-warning::before {
        content: "\e703";
    }

    .e-sticky#InlineEditing_toolbarItems {
        top: 78px !important;
    }

    .e-gridheader.e-lib.e-droppable.e-sticky {
        top: 117px !important;
    }
</style>

<style>

    .divIDClass {
        z-index: 999999 !important;
    }

    .datagrid .table tr td img {
        height: 30px;
    }

    .showbox {
        display: none !important;
    }

    #loadbox {
        position: fixed;
        top: 0px;
        left: 0px;
        width: 100%;
        height: 100%;
        background: #000;
        z-index: 999;
        display: none;
    }
</style>

<style>
    @@font-face {
        font-family: 'Toast_icons';
        src: url(data:application/x-font-ttf;charset=utf-8;base64,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) format('truetype');
        font-weight: normal;
        font-style: normal;
    }

    #toast_types button {
        margin: 5px;
        min-width: 160px;
        max-width: 160px;
    }


    .toast-icons {
        font-family: 'Toast_icons' !important;
        speak: none;
        font-size: 55px;
        font-style: normal;
        font-weight: normal;
        font-variant: normal;
        text-transform: none;
        line-height: 1;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    #toast_type .e-toast-icon.e-icons {
        height: auto;
        font-size: 30px;
    }

    .bootstrap5 #toast_type .e-toast-icon.e-icons,
    .bootstrap5-dark #toast_type .e-toast-icon.e-icons {
        height: 25px;
    }

    .toast-icons.e-success::before {
        content: "\e701";
    }

    .toast-icons.e-error::before {
        content: "\e700";
    }

    .toast-icons.e-info::before {
        content: "\e704";
    }

    .toast-icons.e-warning::before {
        content: "\e703";
    }

    .e-gridheader.e-lib.e-droppable.e-sticky {
        top: 230px !important;
    }

    .viewBtnUnclearCheck {
        width: auto;
        padding: 10px 20px;
        text-decoration: none;
        color: white;
        background-color: rgb(83, 115, 244);
        box-shadow: 0px 0px 20px rgba(83, 115, 244,0.3);
        border-radius: 6px;
        border: 0px;
        transition: all 0.2s ease-in-out;
    }

        .viewBtnUnclearCheck:hover, .resetBtnUnclearCheck:hover {
            text-decoration: none;
            color: white;
            transform: scale(1.1);
        }

    .resetBtnUnclearCheck {
        width: auto;
        padding: 10px 20px;
        text-decoration: none;
        color: white;
        background-color: rgb(244, 161, 83);
        box-shadow: 0px 0px 20px rgb(244, 161, 83,0.3);
        border-radius: 6px;
        border: 0px;
        margin: 0px 10px;
        height: 35px;
        transition: all 0.2s ease-in-out;
    }

    .e-sticky#InlineExpenseEditing_toolbarItems {
        top: 175px !important;
    }
</style>
<div>
    @if (Convert.ToString(ViewBag.Storeidvalue) == "0")
    {
        <script>
            PopUpSelectStore()
        </script>
    }
</div>
<div id="popupStoreAlert" class="divIDClass modal-popup modal-danger modal-message" style="position: fixed;  left:45%; width:300px; top: 30%; display:none">
    <div class="modal-content ">
        <div class="modal-header text-center">
            <i class="glyphicon glyphicon-fire"></i>
        </div>
        <div class="modal-title">No Store Selected</div>
        <div class="modal-body ">Please Select Store.</div>
        <div class="modal-footer " style="text-align:center">
            <a class="btn btn-danger" data-dismiss="modal" onclick="closemodal()" ;>Ok </a>
        </div>
    </div>
</div>
<div class="animate-panelmessesgarea padbtmzero">
    @if (Convert.ToString(ViewBag.StatusMessage) == "Success Expense")
    {
        <script>
            MyCustomAlert('Expense Created Successfully.', 1);
        </script>
    }
    @if (Convert.ToString(ViewBag.StatusMessage) == "Error Expense")
    {
        <script>
            MyCustomAlert('Expense Not Created.', 2);
        </script>
    }
    @if (Convert.ToString(ViewBag.StatusMessage) == "Success Check")
    {
        <script>
            MyCustomAlert('Check Created Successfully.', 1);
        </script>
    }
    @if (Convert.ToString(ViewBag.StatusMessage) == "Error Check")
    {
        <script>
            MyCustomAlert('Check Not Created.', 2);
        </script>
    }
</div>
@Html.EJS().Toast("toast_type").NewestOnTop(true).ShowCloseButton(true).Position(p => p.X("Right")).TimeOut(5000).Render()

<div class="loading-containers loading-inactives" style="display:none;">
    <div class="loaders"></div>
</div>
<div class="header-small special_bg" style="margin: 0px;position:sticky;top:78px;z-index:99">
    <div class="row">
        <div class="col-md-3">
            <h3>Recent Expenses/Checks</h3>
        </div>
        <div class="col-md-3">
            <label>StartDate</label>
            @Html.EJS().DatePicker("StartDate").Format("MM-dd-yyyy").Change("OnChangeStartDate").Max(DateTime.Now).Render()
        </div>
        <div class="col-md-3">
            <label>EndDate</label>
            @Html.EJS().DatePicker("EndDate").Format("MM-dd-yyyy").Max(DateTime.Now).Change("OnChangeEndDate").Render()
        </div>
        <div class="col-md-3">
            <a href="javascript:viewdata();" class="viewBtnUnclearCheck" data-toggle="tooltip" data-placement="top" data-original-title="" title="">Filter</a>
            &nbsp;&nbsp;&nbsp;&nbsp;
            <button type="button" class="resetBtnUnclearCheck" onclick="reset();">Reset</button>
        </div>
        <div>
            <span class="pull-right">
                @*<input type="button" class="buttonbox btn-info" onclick="ExcludedExpenseList();" value="Include" />*@
                <span class="pull-right" style="width:160px;">
                    <select id="ddlStatus" name="Status" class="pull-right">
                        <option value="">--Select--</option>
                        @if (Roles.IsUserInRole("Administrator") || Roles.IsUserInRole("AllExpenseCheck"))
                        {
                            <option value="All">All</option>
                            <option value="Include">Include</option>
                            <option value="Exclude">Exclude</option>
                            <option value="Override">Override</option>
                        }
                        @if (Roles.IsUserInRole("IncludeExpenseCheck"))
                        {
                            <option value="Include">Include</option>
                        }
                        @if (Roles.IsUserInRole("ExcludeExpenseCheck"))
                        {
                            <option value="Exclude">Exclude</option>
                        }
                        @if (Roles.IsUserInRole("IncludeExpenseCheck") || Roles.IsUserInRole("ExcludeExpenseCheck"))
                        {
                            <option value="Override">Override</option>
                        }
                    </select>
                </span>
            </span>

            @*<label>Status:</label>*@


        </div>
    </div>

</div>
<div id="grddata">
    <div class="page-body headertopbox addinvoice" style="padding-top:0px!important;">
        <div class="control-section">
            <div id="customDialog"></div>
            @Html.EJS().Grid("InlineExpenseEditing").AllowSorting().AllowFiltering().FilterSettings(filter => { filter.Type(Syncfusion.EJ2.Grids.FilterType.CheckBox); }).Created("created").SelectionSettings(sel => { sel.PersistSelection(true); }).EnableStickyHeader(true).AllowTextWrap().Columns(col =>
       {
           col.Field("QBType").HeaderText("QBType").Visible(false).Add();
           col.Field("ViewDocFlg").HeaderText("ViewDocFlg").Width("50").Visible(false).Add();
           col.Field("ExpenseCheckDetailId").HeaderText("ExpenseCheckDetailId").Visible(false).Add();
           col.Field("ExpenseCheckId").IsPrimaryKey(true).HeaderText("ExpenseCheckId").Visible(false).Add();


           col.Field("VendorName").HeaderText("Name").Width("130").Add();
           col.Field("StoreName").HeaderText("Store").Width("50").Add();
           col.Field("Type").HeaderText("Type").Width("50").Add();
           col.Field("InvoiceDate").HeaderText("Date").Format("MM-dd-yyyy").Width("60").Add();
           col.Field("DocNumber").HeaderText("No #").Width("50").Add();
           col.Field("TotalAmount").HeaderText("Amount").Width("60").Template("#amountTemplate").AllowSorting(false).Add();
           col.Field("Department").HeaderText("Department").Width("100").Add();
           col.Field("Memo").HeaderText("Memo").Width("130").Add();
           col.Field("InvoiceId").HeaderText("Docs").Width("60").Template("#DocsTemplate").AllowSorting(false).AllowFiltering(false).Add();
           col.Field("DisplayExpenseStatus").HeaderText("Status").Template("#DisplayStatusTemplate").Width("70").Add();
           col.HeaderText("Action").Width("60").Template("#EditTemplate").AllowFiltering(false).Add();
       }).DataBound("dataBound").ActionBegin("actionBegin").ActionComplete("actionComplete").AllowPaging().PageSettings(page => { page.PageCount(2).PageSize(500); }).EditSettings(edit => { edit.AllowAdding(true).AllowEditing(true).Mode(Syncfusion.EJ2.Grids.EditMode.Dialog).Template("#dialogtemplates"); }).Toolbar(toolbarItems).ToolbarClick("toolbarClick").Render()
        </div>
    </div>
</div>

<div class="modal fade" id="IModal" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content" style="margin-top:14%">
            <div class="modal-header text-center">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Upload Expense/Check Document</h4>
            </div>
            @*@using (Html.BeginForm("SaveExpenseDocument", "ExpenseCheckSetting", FormMethod.Post, new { id = "frmExpense" }))
                {
                    @Html.AntiForgeryToken()
                    @Html.ValidationSummary(true)*@
            <div class="modal-body">
                <div id="frmUserType" class="form-horizontal">
                    @Html.Editor("ExpenseId", new { htmlAttributes = new { @class = "form-control", style = "display:none" } })

                    <div class="form-group">
                        <label style="font-weight:bold;font-size:medium">&nbsp;&nbsp; Upload Document :</label>
                        <span style="width:500px;">
                            <input type="file" name="postedFile" id="fileinput" class="fileut" /> @*<input type="submit" id="UploadPDF" value="Import Excel" class="btn btn-success" />*@
                            @*<input class="form-control" type="file" name="importFile" id="importFile" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" style="padding: 3px;" />*@
                        </span>
                    </div>
                    @*@{ Html.RenderAction("AddUserType", new EntityModels.Models.UserTypeMaster()); }*@
                </div>
            </div>
            <div class="modal-footer modal-delete-footer">
                <input form="UpLedger" type="button" class="buttonbox btnsubmit" detail="Recent Expenses/Checks Upload Docs -" value="Save" onclick="AddDocument();" />
                @*<input  type="submit" class="buttonbox btnsubmit" value="Save"/>*@
                <button type="button" class="buttonbox btncancel" detail="Recent Expenses/Checks Upload Docs -" data-dismiss="modal">Close</button>
            </div>
            @*}*@
        </div>
    </div>
</div>

<div class="modal fade" id="ViewFile" role="dialog">
    <div class="modal-dialog modal-xl">
        <div class="modal-content" style="margin-top:14%;">
            <div class="modal-header text-center">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Document List</h4>

            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered" id="tblUploadFile" style="width:100%;max-height:200px;">
                        <thead>
                            <tr>
                                <th>Document Name</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="UploadDocumentFile"></tbody>

                    </table>
                    <hr />
                </div>
                <div class="modal-footer modal-delete-footer">
                    <button type="button" class="buttonbox btncancel" detail="Recent Expenses/Checks View Docs -" data-dismiss="modal">Close</button>
                </div>
            </div>

        </div>
    </div>
</div>

<div id="ModelPopup">

</div>


<script id='dialogtemplates' type="text/x-template">
    <div id="dialogTemp">
    </div>
</script>
<script>
    var scrollVal = 0;
    document.title = '@ViewBag.Title';
    function closemodal() {
        $(".divIDClass").hide();
    }
</script>


@*Old page js*@
<script>
    function viewdata() {

        var grid = document.getElementById("InlineExpenseEditing").ej2_instances[0];
        grid.dataSource = new ej.data.DataManager({
            url: "/ExpenseAccounts/UrlDatasourceExpense?Status=" + $("#ddlStatus").val() + "&startdate=" + $("#StartDate").val() + "&enddate=" + $("#EndDate").val(),
            adaptor: new ej.data.UrlAdaptor()
        });
    }

    function reset() {
        window.location.reload();
    }

    $('#ddlStatus').on('change', function () {


        var grid = document.getElementById("InlineExpenseEditing").ej2_instances[0];
        grid.dataSource = new ej.data.DataManager({
            url: "/ExpenseAccounts/UrlDatasourceExpense?Status=" + $("#ddlStatus").val() + "&startdate=" + $("#StartDate").val() + "&enddate=" + $("#EndDate").val(),
            adaptor: new ej.data.UrlAdaptor()
        });

    });

</script>

<script type="text/x-jsrender" id="amountTemplate">
    ${if(QBType == "CREDITCARDCREDIT")}
    <span style="color:red;text-align:right">@Html.Raw("($ ")${AmountString}@Html.Raw(")")</span>
    ${else}
    <span style="text-align:right">@Html.Raw("$ ")${AmountString}</span>
    ${/if}
</script>

<script type="text/x-jsrender" id="DocsTemplate">
    <a href="javascript:AddDocPopup(${InvoiceId});" Detail="Recent Expenses/Checks Upload Docs" class="modl" id="modl">
        <img src="/Content/Admin/images/cloud-upload (1).png" alt="" style="width:22px;" />
    </a>
    ${if(ViewDocFlg > 0)}
    &nbsp;&nbsp;
    <a href="javascript:UploadFile(${InvoiceId});" Detail="Recent Expenses/Checks View Docs" class="UploadFile" id="UploadFile">
        <img src="/Content/Admin/images/share.png" alt="" style="width:18px;" />
    </a>
    ${/if}
</script>

<script type="text/x-jsrender" id="DisplayStatusTemplate">
    @*<span class="expenseStatusExclude override-Status">Exlude</span>
        <span class="expenseStatusInclude override-Status">Include</span>*@
    ${if (ExpenseStatus == "Force Include")}
    <span class="expenseStatusInclude override-Status">${DisplayExpenseStatus}</span>
    ${else if(ExpenseStatus == "Force Exclude")}
    <span class="expenseStatusExclude override-Status ">${DisplayExpenseStatus}</span>
    ${else if(ExpenseStatus == "Include")}
    <span class="expenseStatusInclude">${DisplayExpenseStatus}</span>
    ${else}
    <span class="expenseStatusExclude">${DisplayExpenseStatus}</span>
    ${/if}
</script>

<script type="text/x-jsrender" id="EditTemplate">
    ${ if (ExpenseStatus == "Include")}
    <a href="javascript:ForceExcludeExpense(${ExpenseCheckDetailId});" detail="Recent Expenses/Checks - ${VendorName}" class="btn-exclude-red" data-toggle="tooltip" data-placement="top" data-original-title="Delete">Exclude</a>
    ${else if(ExpenseStatus == "Exclude")}
    <a href="javascript:ForceIncludeExpense(${ExpenseCheckDetailId});" detail="Recent Expenses/Checks - ${VendorName}" class="btn-info-blue" data-toggle="tooltip" data-placement="top" data-original-title="Delete">Include</a>
    ${else if(ExpenseStatus == "Force Exclude")}
    <a href="javascript:IncludeExpense(${ExpenseCheckDetailId});" detail="Recent Expenses/Checks - ${VendorName}" class="btn-info-blue" data-toggle="tooltip" data-placement="top" data-original-title="Delete">Include</a>
    ${else}
    <a href="javascript:ExcludeExpense(${ExpenseCheckDetailId});" detail="Recent Expenses/Checks - ${VendorName}" class="btn btn-danger" data-toggle="tooltip" data-placement="top" data-original-title="Delete">Exclude</a>
    ${/if}
</script>

<script>

    $(document).ready(function () {
        $('#txtstartdate').attr('autocomplete', 'off');
        $('#txtenddate').attr('autocomplete', 'off');
        $("#search-box").attr('autocomplete', 'off');
        $("#search-box").focus();
        Loader(0);
        $('#txtstartdate').datetimepicker({
            format: 'MM-DD-YYYY',
            useCurrent: false
        });
        $('#txtenddate').datetimepicker({
            format: 'MM-DD-YYYY',
            useCurrent: false
        });

        $('#txtstartdate').on("dp.change", function (e) {
            $('#txtenddate').data("DateTimePicker").minDate(e.date);
        });
        $('#txtenddate').click("dp.change", function (e) {
            $('#txtenddate').data("DateTimePicker").minDate($('#txtstartdate').val());
        });

    });

    function dataBound(e) {

        var grid = document.getElementsByClassName('e-grid')[0].ej2_instances[0];
        //  checks whether the cancel icon is already present or not
        if (!grid.element.getElementsByClassName('e-search')[0].classList.contains('clear')) {
            var span = ej.base.createElement('span', {
                id: grid.element.id + '_searchcancelbutton',
                className: 'e-clear-icon'
            });
            span.addEventListener('click', (args) => {
                document.querySelector('.e-search').getElementsByTagName('input')[0] = "";
                grid.search("");
            });
            grid.element.getElementsByClassName('e-search')[0].appendChild(span);
            grid.element.getElementsByClassName('e-search')[0].classList.add('clear');
        }

    }


    function AddDocPopup(iii) {

        //$("#IModal").show();
        $('#IModal').modal('show');
        //$(".fileut").text('');
        $(".file-input-name").text('');
        $(".fileut").val('');
        $("#ExpenseId").val(iii)
    };

    function AddDocument() {
    var ExpenseId = $('#ExpenseId').val();
    var files = $("#fileinput").get(0).files;
    var ExpenseId = $("#ExpenseId").val();

    var formData = new FormData();
    formData.append('fileinput', files[0]);
    formData.append('ExpenseId', ExpenseId);
    $.ajax({
        url: '/ExpenseAccounts/SaveExpenseDocument',
        type: "post",
        data: formData,
        contentType: false,
        processData: false,
        beforeSend: function () { Loader(1); },
        success: function (states) {
            if (states == "OK") {
                $("#fileinput").text("");
                $('#IModal').modal('hide');
                toastr.success('@ViewBag.DocSaved');

                var grid = document.getElementById("InlineExpenseEditing").ej2_instances[0];
                grid.dataSource = new ej.data.DataManager({
                    url: "/ExpenseAccounts/UrlDatasourceExpense",
                    adaptor: new ej.data.UrlAdaptor()
                });

            }
            Loader(0);
        }
    });
    }

    function UploadFile(iii) {    
    var id = iii;
    $.ajax({
        url: '@AdminSiteConfiguration.GetURL()/ExpenseAccounts/ExcludedExpenseListDocument',
        data: { ExpenseCheckID: id },
        async: false,
        success: function (response) {

            if (response.list.length > 0) {
                var htmls = "";
                var htmlModel = "";
                $.each(response.list, function (index, value) {
                    // Extract file name from the complete path
                    var fileName = value.DocumentName.split('\\').pop();
                    htmls += "<tr>";
                    htmls += "<td> <a href='/UserFiles/ExpenseDocuments/" + value.DocumentName + "' style='padding-left: 14px;' target = '_blank' >" + fileName + "</a></td>";
                    if (response.type == 1 || response.id == value.CreatedBy) {
                        htmls += "<td> <a href='#' onclick='return ErrorPopup(" + value.ExpenseCheckDocumentId + ");' data-toggle='tooltip' data-placement='top' data-original-title='Delete'><img src='../Content/Admin/images/trash-2.svg' alt=''/> </a></td>";
                    }
                    else {
                        htmls += "<td></td>"
                    }
                    htmls += "</tr>";
                    if (response.type == 1 || response.id == value.CreatedBy) {
                        htmlModel += "<div id='" + value.ExpenseCheckDocumentId + "' class='divIDClass modal-popup modal-danger modal-message' style='position: fixed;  left:45%; width:300px; top: 10px; display:none'>";
                        htmlModel += "<div class='modal-content '>";
                        htmlModel += "<div class='modal-header text-center'>";
                        htmlModel += "<i class='glyphicon glyphicon-trash'></i>";
                        htmlModel += "</div>";
                        htmlModel += "<div class='modal-title'>Message</div>";
                        htmlModel += "<div class='modal-body '>Are you sure you want to remove this Document?</div>";
                        htmlModel += "<div class='modal-footer' style='text-align:center'>";
                        htmlModel += "<a class='btn btn-danger' onclick='Delete(" + value.ExpenseCheckDocumentId + ")'>Yes </a>";
                        htmlModel += "<a class='btn' data-dismiss='modal' onclick='closemodal()'>No</a>";
                        htmlModel += "</div>";
                        htmlModel += "</div>";
                        htmlModel += "</div>";
                        $("#ModelPopup").html("");
                        $("#ModelPopup").append(htmlModel);
                    }
                });
                $("#UploadDocumentFile").html("");
                $("#UploadDocumentFile").append(htmls);
            }
            else {
                $("#UploadDocumentFile").html("");
            }
            $('#ViewFile').modal('show');
        },
        error: function () {
            Loader(0);
        }
    });
    }

    function Delete(ID) {

        $('.modal-backdrop').hide();
        $.ajax({
            url: '/ExpenseAccounts/delete',
            data: { Id: ID },
            async: false,
            success: function (response) {
                //window.location.reload();
                var grid = document.getElementById("InlineExpenseEditing").ej2_instances[0];
                grid.refresh();
                $('#ViewFile').modal('hide');
                closemodal();
                var toastObj = document.getElementById('toast_type').ej2_instances[0];
                toastObj.content = "File Deleted Successfully.";
                toastObj.target = document.body;
                toastObj.show({ title: 'Success!', cssClass: 'e-toast-success', icon: 'e-success toast-icons' });
                return true;
            },
            error: function () {
                return false;
            }
        });
    }

      function ExcludeExpense(iii) {

    $.ajax({
        url: '@AdminSiteConfiguration.GetURL()/ExpenseAccounts/ExcludeExpense',
        data: { ExpenseId: iii},
        beforeSend: function () { Loader(1); },
        async: false,
        success: function (states) {
            if (states == "OK") {
                toastr.success('@ViewBag.ExcExpense');
                window.location.reload();
            }
            Loader(0);
        },
        error:function()
        {
            Loader(0);
        }
    });
}

function IncludeExpense(iii) {

    $.ajax({
        url: '@AdminSiteConfiguration.GetURL()/ExpenseAccounts/IncludeExpense',
        data: { selectedval: iii},
        beforeSend: function () { Loader(1); },
        async: false,
        success: function (states) {
            if (states == "OK") {
                toastr.success('@ViewBag.ExcExpense');
                window.location.reload();
            }
            Loader(0);
        },
        error:function()
        {
            Loader(0);
        }
    });
}


function ForceIncludeExpense(iii) {

    $.ajax({
        url: '@AdminSiteConfiguration.GetURL()/ExpenseAccounts/ForceIncludeExpense',
        data: { selectedval: iii},
        beforeSend: function () { Loader(1); },
        async: false,
        success: function (states) {

            if (states == "OK") {

                toastr.success('@ViewBag.ExcExpense');
               window.location.reload();
            }
            Loader(0);
        },
        error:function()
        {
            Loader(0);
        }
    });
}

  function ForceExcludeExpense(iii) {

    $.ajax({
        url: '@AdminSiteConfiguration.GetURL()/ExpenseAccounts/ForceExcludeExpense',
        data: { selectedval: iii},
        beforeSend: function () { Loader(1); },
        async: false,
        success: function (states) {

            if (states == "OK") {

                toastr.success('@ViewBag.ExcExpense');
                window.location.reload();
            }
            Loader(0);
        },
        error:function()
        {
            Loader(0);
        }
    });
}

    function OnChangeStartDate(args) {
        var one = formatDate(new Date(args.value.toDateString()));

        var onClickText = "Expenses StartDate " + one;

        if (onClickText != null && onClickText != "" && onClickText != undefined) {
            GetActivityLogDetails("Date", onClickText);
            $.ajax({
                url: '/ActivityLog/AddActivityLoad',
                data: { onClickText: onClickText, ActionName: ActionName, ControllerName: ControllerName, ModuleName: ModuleName, PageName: PageName, LblAction: LblAction, Message: LblMessage },
                async: false,
                success: function (response) {
                    return true;
                },
                error: function () {

                }
            });
        }
    }

    function OnChangeEndDate(args) {
        var one = formatDate(new Date(args.value.toDateString()));

        var onClickText = "Expenses EndDate " + one;

        if (onClickText != null && onClickText != "" && onClickText != undefined) {
            GetActivityLogDetails("Date", onClickText);
            $.ajax({
                url: '/ActivityLog/AddActivityLoad',
                data: { onClickText: onClickText, ActionName: ActionName, ControllerName: ControllerName, ModuleName: ModuleName, PageName: PageName, LblAction: LblAction, Message: LblMessage },
                async: false,
                success: function (response) {
                    return true;
                },
                error: function () {

                }
            });
        }
    }



    function toolbarClick(args) {
        var gridObj = document.getElementById("InlineExpenseEditing").ej2_instances[0];
        if (args.item.id === 'InlineExpenseEditing_pdfexport') {

            gridObj.serverPdfExport("/ExpenseAccounts/PdfExport?startdate=" + $("#StartDate").val() + "&enddate=" + $("#EndDate").val() + "&Status=" + $("#ddlStatus").val());
        }
        if (args.item.id === 'InlineExpenseEditing_excelexport') {
            gridObj.serverPdfExport("/ExpenseAccounts/ExcelExport?startdate=" + $("#StartDate").val() + "&enddate=" + $("#EndDate").val() + "&Status=" + $("#ddlStatus").val());
        }
        if (args.item.id === "delete") {            
            var selectedRecords = this.getSelectedRecords();
            if (selectedRecords.length === 0) {
                showCustomDialog("No records selected for delete operation.");
            } else {
                var selectedPrimaryKey = selectedRecords[0]["ExpenseCheckId"];
                showConfirmationDialog('Are you sure you want to delete this record?', function (result) {
                    if (result) {
                        $.ajax({
                            url: '/ExpenseAccounts/RemoveExpenseCheck', // URL to your server-side delete endpoint
                            type: 'POST', // or 'GET', depending on your server-side implementation
                            data: {
                                ExpenseCheckId: selectedPrimaryKey
                            }, // Data to send to the server
                            success: function (response) {
                                // Handle success response from the server
                                var toastObj = document.getElementById('toast_type').ej2_instances[0];
                                if (response.success) {
                                    // Reload the page or update UI as needed
                                    var grid = document.getElementById("InlineExpenseEditing").ej2_instances[0];
                                    grid.refresh();
                                    toastObj.content = response.success;
                                    toastObj.target = document.body;
                                    toastObj.show({ title: 'Success!', cssClass: 'e-toast-success', icon: 'e-success toast-icons' });
                                } else {
                                    // Handle error or display error message
                                    toastObj.content = response.message;
                                    toastObj.target = document.body;
                                    toastObj.show({ title: 'Error!', cssClass: 'e-toast-danger', icon: 'e-error toast-icons' });
                                }
                            },
                            error: function (xhr, status, error) {
                                // Handle AJAX call error
                                console.error(xhr.responseText);
                            }
                        });
                    } else {
                        console.log("Closed");
                        // User clicked Cancel or closed the dialog
                        // Handle the cancellation or take appropriate action
                    }
                    //$("#customDialog").hide();
                });
            }
        }
    }

    function showConfirmationDialog(message, callback) {
        // Create a new Dialog instance
        var dialog = new ej.popups.Dialog({
            header: 'Confirmation', // Set dialog header
            content: message, // Set dialog content to the message
            width: '300px', // Set dialog width
            animationSettings: { effect: 'Zoom' }, // Set animation effect
            buttons: [
                {
                    buttonModel: {
                        content: 'OK',
                        isPrimary: true,
                    },
                    click: function () {
                        if (typeof callback === 'function') {
                            callback(true); // Invoke the callback function with true
                        }
                        dialogButtonClick.call(this); // Hide and destroy the dialog
                    }
                },
                {
                    buttonModel: {
                        content: 'Cancel'
                    },
                    click: function () {
                        if (typeof callback === 'function') {
                            callback(false); // Invoke the callback function with false
                        }
                        dialogButtonClick.call(this); // Hide and destroy the dialog
                    }
                }
            ] // Add OK and Cancel buttons
        });

        // Render the dialog
        dialog.appendTo('#customDialog');
        dialog.show(); // Show the dialog

        var gridContainer = document.getElementById('grddata');
        gridContainer.classList.add('blur-background');
    }

    function showCustomDialog(message) {
        // Create a new Dialog instance
        var dialog = new ej.popups.Dialog({
            header: 'Alert', // Set dialog header
            content: message, // Set dialog content to the message
            width: '300px', // Set dialog width
            animationSettings: { effect: 'Zoom' }, // Set animation effect
            buttons: [{ buttonModel: { content: 'OK', isPrimary: true }, click: dialogButtonClick }], // Add OK button
        });

        // Render the dialog
        dialog.appendTo('#customDialog');
        dialog.show(); // Show the dialog

        var gridContainer = document.getElementById('grddata');
        gridContainer.classList.add('blur-background');
    }
    function dialogButtonClick() {
        this.hide(); // Hide the dialog when OK button is clicked
        this.destroy(); // Destroy the dialog instance
        document.getElementById('customDialog').innerHTML = '';

        var gridContainer = document.getElementById('grddata');
        gridContainer.classList.remove('blur-background');
    }

</script>

<script>
    var Expensestoreid = '@ViewBag.Storeidvalue';
</script>
@*<script src="~/Form_JS/ExpenseCheck.js?version=@System.Configuration.ConfigurationManager.AppSettings["version"].ToString()"></script>*@
@Html.EJS().ScriptManager()