document.addEventListener("DOMContentLoaded", (() => {
    const e = document.querySelector(".notes-wrapper"),
        t = (document.querySelector(".full-w-wrapper"), {
            tolerance: 10,
            snapPoints: [580, 640, 720, 840, 960, 1024, 1184, 1280, 1440, 1600]
        });
    let n = !1;
    e.addEventListener("mousemove", (n => {
        const s = e.getBoundingClientRect();
        n.clientX < s.left + t.tolerance && n.clientX > s.left ? (e.style.cursor = "col-resize", e.classList.add("resizable-indicator")) : (e.style.cursor = "default", e.classList.remove("resizable-indicator"))
    })), e.addEventListener("mouseleave", (() => {
        e.style.cursor = "default", e.classList.remove("resizable-indicator")
    })), e.addEventListener("mousedown", (s => {
        const o = e.getBoundingClientRect();
        s.clientX < o.left + t.tolerance && s.clientX > o.left && (n = !0, document.body.style.cursor = "col-resize", e.classList.add("unselectable"))
    })), document.addEventListener("mousemove", (s => {
        if (n) {
            let n = e.getBoundingClientRect().right - s.clientX;
            for (let e = 0; e < t.snapPoints.length; e++)
                if (Math.abs(n - t.snapPoints[e]) <= t.tolerance) {
                    n = t.snapPoints[e];
                    break
                } n < t.snapPoints[0] ? n = t.snapPoints[0] : n > t.snapPoints[t.snapPoints.length - 1] && (n = t.snapPoints[t.snapPoints.length - 1]), e.style.width = `${n}px`
        }
    })), document.addEventListener("mouseup", (() => {
        n && (n = !1, document.body.style.cursor = "default", e.classList.remove("resizable-indicator", "unselectable"))
    }))
})), document.addEventListener("DOMContentLoaded", (() => {
    const e = document.getElementById("createNotesBtn"),
        t = document.getElementById("creatNotesMenu"),
        n = e.querySelector("img.arrow-down");
    t.style.display = "none", e.addEventListener("click", (() => {
        "none" === t.style.display ? (t.style.display = "flex", n.style.transform = "rotate(180deg)") : (t.style.display = "none", n.style.transform = "rotate(0deg)")
    })), document.addEventListener("click", (s => {
        e.contains(s.target) || (t.style.display = "none", n.style.transform = "rotate(0deg)")
    }))
})), document.addEventListener("DOMContentLoaded", (() => {
    const e = document.querySelectorAll(".notes-header-container ul li"),
        t = document.querySelector(".notes-module-container"),
        n = document.querySelector(".task-module-container"),
        s = document.querySelector(".reminder-module-container");

    function o(o) {
        e.forEach((e => e.classList.remove("active"))), e.forEach((e => {
            e.querySelector("span").textContent.trim() === o && e.classList.add("active")
        })), t.style.display = "none", n.style.display = "none", s.style.display = "none", "Notes" === o ? t.style.display = "flex" : "Tasks" === o ? n.style.display = "flex" : "Reminders" === o && (s.style.display = "flex")
    }
    n.style.display = "none", s.style.display = "none", e.forEach((e => {
        e.addEventListener("click", (() => {
            o(e.querySelector("span").textContent.trim())
        }))
    })), e.forEach((e => {
        if (e.classList.contains("active")) {
            o(e.querySelector("span").textContent.trim())
        }
    }))
})), document.addEventListener("DOMContentLoaded", (function () {
    const e = new Quill("#noteEditor", {
        theme: "snow",
        modules: {
            toolbar: [
                [{
                    header: [1, 2, 3, !1]
                }],
                ["bold", "italic", "underline", "strike"],
                [{
                    list: "ordered"
                }, {
                    list: "bullet"
                }]
            ]
        }
    });
    //save data
    document.getElementById("saveNote").addEventListener("click", (function () {
        var noteId = document.getElementById("noteIdHidden").value;
        var noteTitle = document.getElementById("noteTitle").value;
        var editorContent = e.root.innerHTML;
        $.ajax({
            url: ROOTURL + "/AdminInclude/CreateUserNote",
            type: 'POST',
            data: JSON.stringify({ noteId: noteId ,noteTitle: noteTitle, editorContent: editorContent }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                if (response.success == "Create") {
                    document.querySelector(".add-note").style.display = "none";
                    document.getElementById("noteIdHidden").value = "";
                    document.getElementById("noteTitle").value = "";
                    document.getElementById("noteTitle").style.display = "none";
                    e.root.innerHTML = "";
                    document.querySelector('.note-listing').innerHTML = response.notesHtml;
                    document.getElementById("UserNoteCount").textContent = response.usernotecount;
                    toastr.success('Note Created Successfully.');
                } else if (response.success == "Update") {
                    document.querySelector(".add-note").style.display = "none";
                    document.getElementById("noteIdHidden").value = "";
                    document.getElementById("noteTitle").value = "";
                    document.getElementById("noteTitle").style.display = "none";
                    e.root.innerHTML = "";
                    document.querySelector('.note-listing').innerHTML = response.notesHtml;
                    document.getElementById("UserNoteCount").textContent = response.usernotecount;
                    toastr.success('Note Updated Successfully.');
                }
                else {
                    document.querySelector(".add-note").style.display = "none";
                    document.getElementById("noteIdHidden").value = "";
                    document.getElementById("noteTitle").value = "";
                    document.getElementById("noteTitle").style.display = "none";
                    e.root.innerHTML = "";
                    document.querySelector('.note-listing').innerHTML = response.notesHtml;
                    $('#UserNoteCount').val(response.usernotecount);
                }
            },
            error: function () {
                Loader(0);
            }
        });
    }))

    //edit data
    document.querySelectorAll(".editNt").forEach(function (element) {
        element.addEventListener("click", function () {
            var noteId = $(this).closest('.note').find('.noteId').val();
            $.ajax({
                url: ROOTURL + "/AdminInclude/EditUserNote",
                type: 'POST',
                data: JSON.stringify({ id: noteId }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.success) {
                        $('#noteTitle').val(data.note.NoteName).css('display', 'block');
                        e.root.innerHTML = data.note.NoteDescription;
                        $('#noteIdHidden').val(data.note.NoteId);
                        $('.add-note').show();
                    }
                },
                error: function () {
                    alert("Failed to load note data.");
                }
            });
        });
    });

    //after save edit data
    jQuery(document).on('click', '.editNs', function () {
        var noteId = $(this).closest('.note').find('.noteId').val();
        $.ajax({
            url: ROOTURL + "/AdminInclude/EditUserNote",
            type: 'POST',
            data: JSON.stringify({ id: noteId }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('#noteTitle').val(data.note.NoteName).css('display', 'block');
                    e.root.innerHTML = data.note.NoteDescription;
                    $('#noteIdHidden').val(data.note.NoteId);
                    $('.add-note').show();
                }
            },
            error: function () {
                alert("Failed to load note data.");
            }
        });
    })

    //delete data
    document.querySelectorAll(".deleteNt").forEach(function (element) {
        element.addEventListener("click", function () {
            var noteId = $(this).closest('.note').find('.noteId').val();
            $("#NoteModuleIdDelete").val(noteId);
            $("#NoteModuleId").val(1);
            $(NoteModuleDeletePopup).show();
            $("#deleModalbodyNoteModule").text("Are you sure you want to delete this Note?");
        });
    });

    //after save delete data
    jQuery(document).on('click', '.deleteNs', function () {
        var noteId = $(this).closest('.note').find('.noteId').val();
        $("#NoteModuleIdDelete").val(noteId);
        $("#NoteModuleId").val(1);
        $(NoteModuleDeletePopup).show();
        $("#deleModalbodyNoteModule").text("Are you sure you want to delete this Note?");
    })

    //save task
    document.getElementById("saveTask").addEventListener("click", (function () {
        var taskId = document.getElementById("taskIdHidden").value;
        var taskName = document.getElementById("taskName").value;
        var taskDescription = document.getElementById("taskDescription").value;
        var priorityId = document.getElementById("PriorityDropData").value;
        var assignTo = document.getElementById("UserDropData").value;
        var dueDate = document.getElementById("dueDate").value;
        if (priorityId != "" && assignTo != "" && dueDate != "") {
            $.ajax({
                url: ROOTURL + "/AdminInclude/CreateUserTask",
                type: 'POST',
                data: JSON.stringify({ taskId: taskId, taskName: taskName, taskDescription: taskDescription, priorityId: priorityId, assignTo: assignTo, dueDate: dueDate }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    if (response.success == "Create") {
                        document.querySelector(".add-task").style.display = "none";
                        document.getElementById("taskIdHidden").value = "";
                        document.getElementById("taskName").value = "";
                        document.getElementById("taskDescription").value = "";
                        $('#PriorityDropData').val(null).trigger('change');
                        $('#UserDropData').val(null).trigger('change');
                        document.getElementById("dueDate").value = "";
                        document.querySelector('.task-listing').innerHTML = response.taskHtml;
                        document.getElementById("UserTaskCount").textContent = response.usertaskcount;
                        toastr.success('Task Created Successfully.');
                    }
                    else if (response.success == "Update") {
                        document.querySelector(".add-task").style.display = "none";
                        document.getElementById("taskIdHidden").value = "";
                        document.getElementById("taskName").value = "";
                        document.getElementById("taskDescription").value = "";
                        $('#PriorityDropData').val(null).trigger('change');
                        $('#UserDropData').val(null).trigger('change');
                        document.getElementById("dueDate").value = "";
                        document.querySelector('.task-listing').innerHTML = response.taskHtml;
                        document.getElementById("UserTaskCount").textContent = response.usertaskcount;
                        toastr.success('Task Created Successfully.');
                    }
                    else {
                        document.querySelector(".add-task").style.display = "none";
                        document.getElementById("taskIdHidden").value = "";
                        document.getElementById("taskName").value = "";
                        document.getElementById("taskDescription").value = "";
                        $('#PriorityDropData').val(null).trigger('change');
                        $('#UserDropData').val(null).trigger('change');
                        document.getElementById("dueDate").value = "";
                        document.querySelector('.task-listing').innerHTML = response.taskHtml;
                        document.getElementById("UserTaskCount").textContent = response.usertaskcount;
                        toastr.success('Task Created Successfully.');
                    }
                },
                error: function () {
                    Loader(0);
                }
            });
        }
        else {
            toastr.error('Please insert all required fields...');
        }
        
    }))


    //edit task data
    document.querySelectorAll(".editTask").forEach(function (element) {
        element.addEventListener("click", function () {
            var taskId = $(this).closest('.task').find('.taskId').val();
            $.ajax({
                url: ROOTURL + "/AdminInclude/EditUserTask",
                type: 'POST',
                data: JSON.stringify({ id: taskId }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.success) {
                        $('#taskName').val(data.task.TaskName);
                        $('#taskDescription').val(data.task.TaskDescription);
                        $('#taskIdHidden').val(data.task.TaskId);
                        $('#PriorityDropData').val(data.task.PriorityId).trigger('change');
                        $('#UserDropData').val(data.task.AssignTo).trigger('change');
                        var timestamp = parseInt(data.task.DueDate.match(/\d+/)[0]);
                        var date = new Date(timestamp);
                        var year = date.getFullYear();
                        var month = ('0' + (date.getMonth() + 1)).slice(-2);
                        var day = ('0' + date.getDate()).slice(-2);
                        var formattedDateForInput = `${year}-${month}-${day}`;
                        $('#dueDate').val(formattedDateForInput);
                        $('.add-task').show();
                    }
                },
                error: function () {
                    alert("Failed to load note data.");
                }
            });
        });
    });

    //after task save edit data
    jQuery(document).on('click', '.editTaskTs', function () {
        var taskId = $(this).closest('.task').find('.taskId').val();
        $.ajax({
            url: ROOTURL + "/AdminInclude/EditUserTask",
            type: 'POST',
            data: JSON.stringify({ id: taskId }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('#taskName').val(data.task.TaskName);
                    $('#taskDescription').val(data.task.TaskDescription);
                    $('#taskIdHidden').val(data.task.TaskId);
                    $('#PriorityDropData').val(data.task.PriorityId).trigger('change');
                    $('#UserDropData').val(data.task.AssignTo).trigger('change');
                    var timestamp = parseInt(data.task.DueDate.match(/\d+/)[0]);
                    var date = new Date(timestamp);
                    var year = date.getFullYear();
                    var month = ('0' + (date.getMonth() + 1)).slice(-2);
                    var day = ('0' + date.getDate()).slice(-2);
                    var formattedDateForInput = `${year}-${month}-${day}`;
                    $('#dueDate').val(formattedDateForInput);
                    $('.add-task').show();
                }
            },
            error: function () {
                alert("Failed to load note data.");
            }
        });
    })


    //delete for task data
    document.querySelectorAll(".deleteTask").forEach(function (element) {
        element.addEventListener("click", function () {
            var taskId = $(this).closest('.task').find('.taskId').val();
            $("#NoteModuleIdDelete").val(taskId);
            $("#NoteModuleId").val(2);
            $(NoteModuleDeletePopup).show();
            $("#deleModalbodyNoteModule").text("Are you sure you want to delete this Task?");
        });
    });

    //after delete task data

    jQuery(document).on('click', '.deleteTaskTs', function () {
        var taskId = $(this).closest('.task').find('.taskId').val();
        $("#NoteModuleIdDelete").val(taskId);
        $("#NoteModuleId").val(2);
        $(NoteModuleDeletePopup).show();
        $("#deleModalbodyNoteModule").text("Are you sure you want to delete this Task?");
    })


    // save reminder
    document.getElementById("saveReminder").addEventListener("click", (function () {
        var reminderId = document.getElementById("reminderIdHidden").value;
        var reminderName = document.getElementById("reminderTitle").value;
        var reminderDescription = document.getElementById("reminderDiscription").value;
        var reminderDate = document.getElementById("ReminderDate").value;
        var now = new Date();
        var selectedDate = new Date(reminderDate);

        if (selectedDate <= now) {
            toastr.error('Reminder date and time must be in the future.');
            return;
        }
        $.ajax({
            url: ROOTURL + "/AdminInclude/CreateUserReminder",
            type: 'POST',
            data: JSON.stringify({ reminderId: reminderId, reminderName: reminderName, reminderDescription: reminderDescription, reminderDate: reminderDate }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                if (response.success == "Create") {
                    document.querySelector(".add-reminder").style.display = "none";
                    document.getElementById("reminderIdHidden").value = "";
                    document.getElementById("reminderTitle").value = "";
                    document.getElementById("reminderDiscription").value = "";
                    document.getElementById("ReminderDate").value = "";
                    document.querySelector('.reminder-listing').innerHTML = response.reminderHtml;
                    document.getElementById("UserReminderCount").textContent = response.userremindercount;
                    toastr.success('Reminder Created Successfully.');
                } else if (response.success == "Update") {
                    document.querySelector(".add-reminder").style.display = "none";
                    document.getElementById("reminderIdHidden").value = "";
                    document.getElementById("reminderTitle").value = "";
                    document.getElementById("reminderDiscription").value = "";
                    document.getElementById("ReminderDate").value = "";
                    document.querySelector('.reminder-listing').innerHTML = response.reminderHtml;
                    document.getElementById("UserReminderCount").textContent = response.userremindercount;
                    toastr.success('Reminder Updated Successfully.');
                }
                else {
                    document.querySelector(".add-reminder").style.display = "none";
                    document.getElementById("reminderIdHidden").value = "";
                    document.getElementById("reminderTitle").value = "";
                    document.getElementById("reminderDiscription").value = "";
                    document.getElementById("ReminderDate").value = "";
                    document.querySelector('.reminder-listing').innerHTML = response.reminderHtml;
                    document.getElementById("UserReminderCount").textContent = response.userremindercount;
                }
            },
            error: function () {
                Loader(0);
            }
        });
    }))

    //edit reminder data
    document.querySelectorAll(".editReminder").forEach(function (element) {
        element.addEventListener("click", function () {
            var reminderId = $(this).closest('.reminder').find('.reminderId').val();
            $.ajax({
                url: ROOTURL + "/AdminInclude/EditUserReminder",
                type: 'POST',
                data: JSON.stringify({ id: reminderId }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.success) {
                        $('#reminderTitle').val(data.reminder.ReminderName);
                        $('#reminderDiscription').val(data.reminder.ReminderDescription);
                        var timestamp = parseInt(data.reminder.ReminderDate.replace("/Date(", "").replace(")/", ""), 10);

                        // Convert the timestamp to a JavaScript Date object
                        var reminderDate = new Date(timestamp);

                        // Get the local date and time components
                        var year = reminderDate.getFullYear();
                        var month = ('0' + (reminderDate.getMonth() + 1)).slice(-2);
                        var day = ('0' + reminderDate.getDate()).slice(-2);
                        var hours = ('0' + reminderDate.getHours()).slice(-2);
                        var minutes = ('0' + reminderDate.getMinutes()).slice(-2);

                        // Format the date and time as 'YYYY-MM-DDTHH:MM'
                        var formattedDateTime = `${year}-${month}-${day}T${hours}:${minutes}`;

                        // Set the value of the datetime-local input
                        $('#ReminderDate').val(formattedDateTime);
                        $('#reminderIdHidden').val(data.reminder.ReminderId);
                        $('.add-reminder').show();
                    }
                },
                error: function () {
                    alert("Failed to load note data.");
                }
            });
        });
    });

    //after save edit reminder data
    jQuery(document).on('click', '.editReminderTs', function () {
        var reminderId = $(this).closest('.reminder').find('.reminderId').val();
        $.ajax({
            url: ROOTURL + "/AdminInclude/EditUserReminder",
            type: 'POST',
            data: JSON.stringify({ id: reminderId }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('#reminderTitle').val(data.reminder.ReminderName);
                    $('#reminderDiscription').val(data.reminder.ReminderDescription);
                    var timestamp = parseInt(data.reminder.ReminderDate.replace("/Date(", "").replace(")/", ""), 10);

                    // Convert the timestamp to a JavaScript Date object
                    var reminderDate = new Date(timestamp);

                    // Get the local date and time components
                    var year = reminderDate.getFullYear();
                    var month = ('0' + (reminderDate.getMonth() + 1)).slice(-2);
                    var day = ('0' + reminderDate.getDate()).slice(-2);
                    var hours = ('0' + reminderDate.getHours()).slice(-2);
                    var minutes = ('0' + reminderDate.getMinutes()).slice(-2);

                    // Format the date and time as 'YYYY-MM-DDTHH:MM'
                    var formattedDateTime = `${year}-${month}-${day}T${hours}:${minutes}`;

                    // Set the value of the datetime-local input
                    $('#ReminderDate').val(formattedDateTime);
                    $('#reminderIdHidden').val(data.reminder.ReminderId);
                    $('.add-reminder').show();
                }
            },
            error: function () {
                alert("Failed to load note data.");
            }
        });
    })

    //delete reminder
    document.querySelectorAll(".deleteReminder").forEach(function (element) {
        element.addEventListener("click", function () {
            var reminderId = $(this).closest('.reminder').find('.reminderId').val();
            $("#NoteModuleIdDelete").val(reminderId);
            $("#NoteModuleId").val(3);
            $(NoteModuleDeletePopup).show();
            $("#deleModalbodyNoteModule").text("Are you sure you want to delete this Remider?");
        });
    });

    //after save delete reminder data
    jQuery(document).on('click', '.deleteReminderTs', function () {
        var reminderId = $(this).closest('.reminder').find('.reminderId').val();
        $("#NoteModuleIdDelete").val(reminderId);
        $("#NoteModuleId").val(3);
        $(NoteModuleDeletePopup).show();
        $("#deleModalbodyNoteModule").text("Are you sure you want to delete this Remider?");
    })

    //common notemodule delete popup 
    jQuery(document).on('click', '#DeleteNoteModule', function () {
        var ntrId = $("#NoteModuleIdDelete").val();
        var notemoduleid = $("#NoteModuleId").val();
        if (notemoduleid == "1") {
            $.ajax({
                url: ROOTURL + "/AdminInclude/DeleteUserNote",
                type: 'POST',
                data: JSON.stringify({ id: ntrId }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.success) {
                        document.querySelector('.note-listing').innerHTML = data.notesHtml;
                        document.getElementById("UserNoteCount").textContent = data.usernotecount;
                        $("#NoteModuleIdDelete").val("");
                        $("#NoteModuleId").val("");
                        $(NoteModuleDeletePopup).hide();
                        toastr.success('Notes Deleted Successfully.');
                    }
                },
                error: function () {
                    alert("Failed to load note data.");
                }
            });
        }
        else if (notemoduleid == "2") {
            $.ajax({
                url: ROOTURL + "/AdminInclude/DeleteUserTask",
                type: 'POST',
                data: JSON.stringify({ id: ntrId }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.success) {
                        document.querySelector('.task-listing').innerHTML = data.taskHtml;
                        document.getElementById("UserTaskCount").textContent = data.usertaskcount;
                        $("#NoteModuleIdDelete").val("");
                        $("#NoteModuleId").val("");
                        $(NoteModuleDeletePopup).hide();
                        toastr.success('Task Deleted Successfully.');
                    }
                },
                error: function () {
                    alert("Failed to load note data.");
                }
            });
        }
        else if (notemoduleid == "3") {
            $.ajax({
                url: ROOTURL + "/AdminInclude/DeleteUserReminder",
                type: 'POST',
                data: JSON.stringify({ id: ntrId }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.success) {
                        document.querySelector('.reminder-listing').innerHTML = data.reminderHtml;
                        document.getElementById("UserReminderCount").textContent = data.userremindercount;
                        $("#NoteModuleIdDelete").val("");
                        $("#NoteModuleId").val("");
                        $(NoteModuleDeletePopup).hide();
                        toastr.success('Reminder Deleted Successfully.');
                    }
                },
                error: function () {
                    alert("Failed to load note data.");
                }
            });
        }
    })

})), document.addEventListener("DOMContentLoaded", (function () {
    document.querySelectorAll(".mark-completed").forEach((function (e) {
        e.addEventListener("click", (function () {
            var taskId = e.closest('.task').querySelector('.taskId').value;
            if (e.classList.contains("completed")) return;
            e.querySelector(".button-content");
            const t = e.querySelector(".button-text"),
                n = e.querySelector(".default-icon");

            e.classList.add("processing"), t.textContent = "Processing", n.src = "/Content/Admin/images/icons/loader.png", n.classList.add("loader-icon"), setTimeout((function () {
                e.classList.remove("processing"), e.classList.add("completed"), e.innerHTML = '\n          <span class="completed-content">\n            <img src="/Content/Admin/images/icons/mark-as-completed.svg" class="completed-icon" />\n            <span class="button-text">Completed</span>\n          </span>\n        '
            }), 2000)

            $.ajax({
                url: ROOTURL + "/AdminInclude/UpdateUserTask",
                type: 'POST',
                data: JSON.stringify({ taskId: taskId }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    document.querySelector('.task-listing').innerHTML = response.taskHtml;
                },
                error: function () {
                    alert("Failed to update task status.");
                }
            });
           
        }))
    }))

    jQuery(document).on('click', '.mark-completedts', function () {
        var taskId = $(this).closest('.task').find('.taskId').val();
        var $this = $(this);  // jQuery object for the clicked element

        if ($this.hasClass("completedts")) return;

        var $buttonContent = $this.find(".button-contentts");
        var $buttonText = $this.find(".button-textts");
        var $defaultIcons = $this.find(".default-iconts");

        $this.addClass("processingts");
        $buttonText.text("Processing");
        $defaultIcons.attr("src", "/Content/Admin/images/icons/loader.png").addClass("loader-iconts");

        setTimeout(function () {
            $this.removeClass("processingts").addClass("completedts").html(`
            <span class="completed-contentts">
                <img src="/Content/Admin/images/icons/mark-as-completed.svg" class="completed-iconts" />
                <span class="button-text">Completed</span>
            </span>
        `);
        }, 2000);

        $.ajax({
            url: ROOTURL + "/AdminInclude/UpdateUserTask",
            type: 'POST',
            data: JSON.stringify({ taskId: taskId }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (response) {
                $('.task-listing').html(response.taskHtml);
            },
            error: function () {
                alert("Failed to update task status.");
            }
        });
    });

})), document.addEventListener("DOMContentLoaded", (() => {
    const e = document.querySelectorAll(".notes-header-container ul li"),
        t = document.getElementById("createNote"),
        n = document.querySelector(".add-note"),
        s = document.querySelector(".notes-module-container"),
        o = document.getElementById("cancelNote"),
        l = document.getElementById("createTask"),
        d = document.querySelector(".add-task"),
        c = document.querySelector(".task-module-container"),
        a = document.getElementById("cancelTask"),
        i = document.getElementById("createReminder"),
        r = document.querySelector(".add-reminder"),
        u = document.querySelector(".reminder-module-container"),
        y = document.getElementById("cancelReminder");

    function m(t, o, l) {
        e.forEach((e => e.classList.remove("active"))), e.forEach((e => {
            e.querySelector("span").textContent.trim() === t && e.classList.add("active")
        })), s.style.display = "none", c.style.display = "none", u.style.display = "none", l.style.display = "flex", l.scrollTop = 0, n.style.display = "none", d.style.display = "none", r.style.display = "none", o.style.display = "flex"
    }
    n.style.display = "none", d.style.display = "none", r.style.display = "none", c.style.display = "none", u.style.display = "none", t.addEventListener("click", (() => {
        m("Notes", n, s)
    })), l.addEventListener("click", (() => {
        m("Tasks", d, c)
    })), i.addEventListener("click", (() => {
        m("Reminders", r, u)
    })), o.addEventListener("click", (() => {
        n.style.display = "none";
        document.getElementById("noteIdHidden").value = "";
        document.getElementById("noteTitle").value = "";
        document.getElementById("noteTitle").style.display = "none";
        //document.getElementById("noteEditor").innerHTML = "";
    })), a.addEventListener("click", (() => {
        d.style.display = "none";
        document.getElementById("taskIdHidden").value = "";
        document.getElementById("taskName").value = "";
        document.getElementById("taskDescription").value = "";
        $('#PriorityDropData').val(null).trigger('change');
        $('#UserDropData').val(null).trigger('change');
        document.getElementById("dueDate").value = "";
    })), y.addEventListener("click", (() => {
        r.style.display = "none";
        document.getElementById("reminderIdHidden").value = "";
        document.getElementById("reminderTitle").value = "";
        document.getElementById("reminderDiscription").value = "";
        document.getElementById("ReminderDate").value = "";
    }))
})), document.addEventListener("DOMContentLoaded", (() => {
    const e = document.getElementById("master-note-module"),
        t = document.getElementById("closeNotePopUp"),
        n = document.getElementById("showNotePopup");
    e.style.display = "none", n.addEventListener("click", (() => {
        e.style.display = "flex"; document.body.classList.add("note-popup-active");
    })), t.addEventListener("click", (() => {
        e.style.display = "none"; document.body.classList.remove("note-popup-active");
    }))
}));

function RemoveBlurBackdrop(event) {
    $("body").removeClass("note-popup-active");
    $('.full-w-wrapper').css('display', 'none');
}

$('#NoteHdSw').click(function (e) {
    $('#createNote').css('display', 'flex');
    $('#createTask').css('display', 'none');
    $('#createReminder').css('display', 'none');
});


$('#TaskHdSw').click(function (e) {
    $('#createTask').css('display', 'flex');
    $('#createNote').css('display', 'none');
    $('#createReminder').css('display', 'none');
});

$('#ReminderHdSw').click(function (e) {
    $('#createReminder').css('display', 'flex');
    $('#createNote').css('display', 'none');
    $('#createTask').css('display', 'none');
});

document.addEventListener("DOMContentLoaded", function () {
    //for reminder date and time
    var now = new Date();
    var year = now.getFullYear();
    var month = String(now.getMonth() + 1).padStart(2, '0');
    var day = String(now.getDate()).padStart(2, '0');
    var hours = String(now.getHours()).padStart(2, '0');
    var minutes = String(now.getMinutes()).padStart(2, '0');
    var currentDateTime = year + '-' + month + '-' + day + 'T' + hours + ':' + minutes;
    document.getElementById('ReminderDate').setAttribute('min', currentDateTime);

    //for taskdate
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('dueDate').setAttribute('min', today);
});

//document.addEventListener("DOMContentLoaded", (() => {
//    const e = document.getElementById("master-note-module"),
//        n = document.getElementById("showNotePopup"),
//        notesWrapper = document.querySelector(".notes-wrapper");

//    // Check if master-note-module and related elements exist before proceeding
//    if (e && n && notesWrapper) {
//        // Initially hide the popup
//        e.style.display = "none";

//        // Function to disable scrolling
//        function disableScroll() {
//            document.body.classList.add("note-popup-active");
//        }

//        // Function to enable scrolling
//        function enableScroll() {
//            document.body.classList.remove("note-popup-active");
//        }

//        // Event listener to show the popup and disable scroll
//        n.addEventListener("click", (() => {
//            e.style.display = "flex";
//            disableScroll();
//        }));

//        // Close the popup if the user clicks outside the .notes-wrapper
//        document.addEventListener("click", (event) => {
//            if (!notesWrapper.contains(event.target) && !n.contains(event.target)) {
//                e.style.display = "none"; // Hide the popup
//                enableScroll(); // Enable scrolling
//            }
//        });

//        // Prevent the click inside the .notes-wrapper from closing the popup
//        notesWrapper.addEventListener("click", (event) => {
//            event.stopPropagation(); // Prevents event from propagating to the document click listener
//        });
//    } else {
//        console.error("Required elements are missing from the DOM.");
//    }
//}));
function closemodalnotemodule(event) {    
    if (event) {
        event.stopPropagation();
    }
    $(NoteModuleDeletePopup).hide();
}