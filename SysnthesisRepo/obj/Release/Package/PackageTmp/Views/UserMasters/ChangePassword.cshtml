@model EntityModels.Models.UserMaster

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<style>
    .divIDClass {
        z-index: 999999 !important;
    }

    h4 {
        text-align: center;
    }

    .container form {
        width: 250px;
        margin: 20px auto;
    }

    i {
        cursor: pointer;
    }

    .toggle-password {
        color: black !important;
        float: right;
        margin-left: -25px;
        margin-top: -33px;
        position: relative;
        margin-right: 5px;
        z-index: 9999 !important;
        font-size: large;
    }

    .errors {
        background: #f9e8e8 none repeat scroll 0 0 !important;
        border-color: #b94a48 !important;
    }
</style>

<div id="globalTabContent">

    <div class="animate-panelmessesgarea padbtmzero">
        @if (Convert.ToString(ViewBag.StatusMessage) == "Success")
        {
            <script>
                MyfunSuccess();
            </script>
        }
        @if (Convert.ToString(ViewBag.StatusMessage) == "Delete")
        {
            <script>
                MyfunSuccess();
            </script>
        }
        @if (Convert.ToString(ViewBag.StatusMessage) == "Error")
        {
            <script>
                MyfunError1();
            </script>
        }
        @if (Convert.ToString(ViewBag.StatusMessage) == "NoItem")
        {
            <script>
                MyfunNoItem();
            </script>
        }
        @if (Convert.ToString(ViewBag.StatusMessage) == "Exists")
        {
            <script>
                MyfunExists();
            </script>
        }
        @if (Convert.ToString(ViewBag.StatusMessage) == "SuccessChangePassword")
        {
            <script>
                MyfunSuccessChangePassword();
            </script>
        }

        @if (Convert.ToString(ViewBag.StatusMessage) == "Chnagepassworderror")
        {
            <script>
                showChangePasswordPopup();
            </script>
        }
    </div>
    <div id="PanAddUpdate">

        <div class="header-small special_bg">
            <h3>Change Password</h3>
        </div>

        @if (!string.IsNullOrEmpty((ViewBag.StatusMessageError)))
        {
            <text>
                <p class="cross" />
            </text>
            @ViewBag.StatusMessageError
        }
        @using (Html.BeginForm(new { ReturnUrl = ViewBag.ReturnUrl }))
        {@Html.AntiForgeryToken()
        @Html.HiddenFor(s => s.UserId)
        @Html.ValidationSummary(true)
        <div class="page-body headertopbox addinvoice" style="padding-top:0px!important;">
            <div class="datagrid martop15">
                <div class="formmain">
                    <div id="popupchangepassword" class="divIDClass modal-popup modal-danger modal-message " style="position: fixed;  left:45%; width:300px; top: 10px; display:none">
                        <div class="modal-content ">
                            <div class="modal-header text-center">
                                <i class="glyphicon glyphicon-fire"></i>
                            </div>
                            <div class="modal-title">Error</div>
                            <div class="modal-body ">Your current password is not correct.</div>
                            <div class="modal-footer " style="text-align:center">
                                <a class="btn btnredbox" data-dismiss="modal" onclick="closemodal()">OK</a>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Current Password</label> <span class="highlight" style="font-size:18px;">*</span>
                                @Html.PasswordFor(m => m.OldPassword, new { maxlength = 100, @class = "form-control" })
                                <span toggle="#OldPassword" class="fa fa-fw fa-eye field-icon toggle-password"></span>
                                @Html.ValidationMessageFor(m => m.OldPassword)

                            </div>
                            <div class="form-group">
                                <label>New Password</label> <span class="highlight" style="font-size:18px;">*</span>
                                @Html.PasswordFor(m => m.Password, new { maxlength = 100, @class = "form-control" })
                                <span toggle="#Password" class="fa fa-fw fa-eye field-icon toggle-password"></span>
                                @Html.ValidationMessageFor(m => m.Password)

                            </div>
                            <div class="form-group">
                                <label>Confirm New Password</label> <span class="highlight" style="font-size:18px;">*</span>
                                @Html.PasswordFor(m => m.ConfirmPassword, new { maxlength = 100, @class = "form-control" })
                                <span toggle="#ConfirmPassword" class="fa fa-fw fa-eye field-icon toggle-password"></span>
                                @Html.ValidationMessageFor(m => m.ConfirmPassword)
                                <span id='message'></span>

                            </div>
                            <div class="form-group">
                                <input id="btnSave" type="submit" value="Change Password" class="buttonbox btnsubmit" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    }

    </div>
</div>
@*@section FooterScript{*@
<script>
    $('#Password, #ConfirmPassword').on('keyup', function () {

        if ($('#Password').val() != "" && $('#ConfirmPassword').val() != "") {
            if ($('#Password').val() == $('#ConfirmPassword').val()) {
                $("#btnSave").prop('disabled', false);
                $('#message').html('Matching').css('color', 'green');
            } else {
                $('#message').html('Not Matching').css('color', 'red');
                //$('.btnsubmit').attr('disabled', 'disabled')
                $("#btnSave").prop('disabled', true);
            }
        }
    });
    $('#OldPassword').on('keyup', function () {
        var OldPwd = $("#OldPassword").val();
        if (OldPwd == "") {
            $("#OldPassword").addClass("errors");
            $("#OldPassword").focus();
            return false;
        }
        else {
            $("#OldPassword").removeClass("errors");
        }
    });
</script>
<script>
    function closemodal() {
        $(".divIDClass").hide();
    }

    function isaggrechange() {
        if ($('#infochangespassword').valid()) {
        }
        else {
            $('#requiredfieldmessage').attr('style', 'display: block');
            $('#requiredfieldmessage').delay(8000).fadeOut('slow');
        }
    }
</script>

<script>
    $("body").on('click', '.toggle-password', function () {
        $(this).toggleClass("fa-eye fa-eye-slash");
        var input = $($(this).attr("toggle"));
        if (input.attr("type") === "password") {
            input.attr("type", "text");
        } else {
            input.attr("type", "password");
        }
    });

    $("#btnSave").click(function () {

        var OldPwd = $("#OldPassword").val();
        if (OldPwd == "") {
            $("#OldPassword").addClass("errors");
            $("#OldPassword").focus();
            return false;
        }
        else {
            $("#OldPassword").removeClass("errors");
        }
    });
</script>

<script type="text/javascript">
document.title = '@ViewBag.Title';
</script>
