@model EntityModels.Models.ExpenseCheck_Setting

@{
    int i = 1;
}
<table class="table table-bordered table-condensed tablesorter" id="ratioTbl">
    <thead>
        <tr>
            <th style="width:20%"><a style="color:#fff; text-decoration:none; cursor:pointer;">Department</a> </th>
            <th style="width:10%"><a style="color:#fff; text-decoration:none; cursor:pointer;">Is Active</a></th>
            <th style="width:70%"><a style="color:#fff; text-decoration:none; cursor:pointer;">Exclude Account</a></th>
        </tr>
    </thead>
    <tbody>
        @if (Model.ExpenseCheck_SettingList != null)
        {
            foreach (var item in Model.ExpenseCheck_SettingList)
            {
                var Class = "row" + i;
                <tr class="@Class">
            <td style="width:20%">@Html.Raw(item.DepartmentName)</td>
            <td style="width:10%"><input type="checkbox" id=@item.DepartmentId value="@item.DepartmentId" checked="@item.IsActive" name="IsActive" style="margin: 1px;position: initial;left: 3%;width: 26px;height: 22px;display: inline;opacity: unset;" /></td>
            <td class="whiteBlock" style="width:70%">
                @Html.DropDownList("DeptExcludeList", new SelectList(item.DeptExcludeList, "Id", "Name"), "Select Account", new { @class = "myval abc synthesisMultipleSelect", name = i + "DeptExcludeList", @multiple = "multiple" })
            </td>
            @Html.Hidden("Deptid", item.DepartmentId)
            @Html.Hidden("Type", item.Type)
            @Html.Hidden("StoreID", item.StoreId)
            @Html.Hidden("DeptList" + i,item.ExcludeList)    
            </tr>
                i = i + 1;
            }
        }
    </tbody>
</table>

<script>
    $(".abc").select2({
        //maximumSelectionLength: 2
    });
        var iCount = 0;
        $("#ratioTbl tbody tr").each(function (index, obj) {
            
            iCount++;
                       
                var aa = $(obj).find("#DeptList" + iCount).val().split(",");
                var el = $(obj).find(".abc")[0];
                for (var j = 0; j < aa.length; j++) {
                    for (var i = 1; i < el.options.length; i++) {
                        if (el.options[i].value == aa[j].trim()) {
                            el[i].selected = true;
                        }
                    }
                    $(obj).find(".abc").trigger('change.select2');
                }

        });

</script>